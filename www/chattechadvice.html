<html> 
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1"> 
    
    <title>Consumer Assistant</title> 
    <link rel="stylesheet"  href="css/style.css" /> 
    <link rel="stylesheet"  href="css/jquery.mobile-1.2.0.css" />  
</head>

<body> 
 
<div data-role="page" id="chattechadvice">
 	<div data-role="header" data-position="fixed">
        <div class="headerlogo"> </div>
	    <div class="headertext">
	       Technical advice by chat
	    </div>
	    <div data-role="controlgroup" data-type="horizontal" style="float:right;" >
	        <a href="index.html" data-role="button" >Home</a>
			<a href="uganda.html" data-role="button" >Back</a>
		</div>
	</div>
 
  	<div data-role="content"> 
	    chatbox
	    <div style="margin-top: 30px;"> 
	       	<table id="chathistory">
	       		<tr>
	       			<td> <!-- name--> </td>
	       			<td> <!-- message--> </td>
	       		</tr>
	   		</table>
	       	
	        
	        <div style="clear: both">
	            <textarea name="chatmessage" id="chatmessage"></textarea>
	            <input type="submit" id="submitchat" value="+"   />
	        </div>
	     </div>
	</div>  
   
  	<div data-role="footer">
    	<h1>footer</h1>
  	</div>
  
<script src="js/jquery.js"></script>
<script src="js/jquery.mobile-1.2.0.js"></script>

<script type="text/javascript">

	$(document).ready(function() {
		showContentMain();
	});

	$('#logmein').click(function () {	
		showTransition();
		doProcessInputs();
		return(false);	// ! mandatory
	});

	function showContentMain(){
		$('#hdrMain').show();
		$('#contentMain').show();
		$('#ftrMain').show();
		$('#contentTransition').hide();
	}
	
	function showTransition(){
		$('#contentTransition').show();
		$('#contentMain').hide();
		$('#hdrMain').hide();
		$('#ftrMain').hide();
	}

	function doProcessInputs(){
		var username=$("#username").val();
		var password=$("#password").val();
		if (username =='') {
			return false;
		} 
		if (password =='') {
			return false;
		} 
		var serviceurl = '../services/accesscontrolaction.php' ;
		
		$.post(
			serviceurl ,
			{ 	username:username, 	password:password, 
				action:'doLogin' ,	type:'consumer' 	
			} ,
		 	function(data){
			    var resobj =jQuery.parseJSON(data);
			    //alert(resobj.result);
			    manageLoginResult(resobj.result);
			}
		);  // end of $.post --
	}
	
	
	function manageLoginResult(result){
		if(result == true){
			location.href = 'index.html';
			//or to the home page.
		}
		else{
			showContentMain();
			$('#setloginerror').append("invalid username / password. Please try again");
		}
	}
	

    
</script>

</div>
</body>
</html>

