<html> 
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1"> 
    
    <title>Consumer Assistant</title> 
    <link rel="stylesheet"  href="css/style.css" /> 
    <link rel="stylesheet"  href="css/jquery.mobile-1.2.0.css" />  
</head>

<body> 

<div data-role="page" id="pageSellerProfileProducts">
  
  	<!--for populating seller profile info div start-->
	<div data-role="header" data-position="fixed" id="hdrProfileInfo">
		<div class="headerlogo"> </div>
		<div class="headertext">
		   Seller Profile 
		</div>
		<div data-role="controlgroup" data-type="horizontal" style="float:right;" >
		    <a href="index.html" data-role="button" >Home</a>
			<a href="?" data-role="button" >Back</a>
		</div>
	</div>
 
  	<div data-role="content" id="contentProfileInfo"> 
	    
	    
	    
  	</div>
  
  	<div data-role="footer" id="ftrProfileInfo">
       
        <div data-role="controlgroup" data-type="horizontal" style="float:center;" >
        	<h1></h1>
       </div>
  	</div>
    <!--____________________________for populating seller profile info div end-->
  
  	<!--for populating seller category info div start-->
	<div data-role="header" data-position="fixed" id="hdrSellerCategory">
		<div class="headerlogo"> </div>
		<div class="headertext">
		   Seller Category 
		</div>
		<div data-role="controlgroup" data-type="horizontal" style="float:right;" >
		    <a href="index.html" data-role="button" >Home</a>
			<a href="?" data-role="button" >Back</a>
		</div>
	</div>
 
  	<div data-role="content" id="contentSellerCategory"> 
	     <label for="category">category:</label><br><br>
	     <div style="border-left: 10px;">	   
	        <ul  id="ulCategoryList" data-role="listview" data-filter="true">
				<!--populate content here through ajax call @runtime-->
			 </ul>
	   </div>    
	    
  	</div>
    
  	<div data-role="footer" id="ftrSellerCategory">
       <div data-role="controlgroup" data-type="horizontal" style="float:center;" >
        	<h1></h1>
        	
		</div>
        
  	</div>
  	<!--______________________________for populating seller category info div end-->
  
  	<!--for populating seller product info under a particular category div start-->	
  	<div data-role="header" data-position="fixed" id="hdrProductUnderCategory">
		<div class="headerlogo"> </div>
		<div class="headertext">
		   Products under the Category 
		</div>
		<div data-role="controlgroup" data-type="horizontal" style="float:right;" >
		    <a href="index.html" data-role="button" >Home</a>
			<a href="?" data-role="button" >Back</a>
		</div>
	</div>
 
  	<div data-role="content" id="contentProductUnderCategory"> 
	    
	    <div data-role="fieldcontain" >
		        <label for="products">products:</label>
		        <select id="products" data-mini="true">
		        	<option value="none"> </option>
			   	</select>
	    	</div>    
	    
  	</div>
    
  	<div data-role="footer" id="ftrProductUnderCategory">
       <div data-role="controlgroup" data-type="horizontal" style="float:center;" >
        	<h1></h1>
       </div>
        
  	</div>
  	<!--____________________________for populating seller product info under a particular category div end-->
  
   	<!--for populating a particular product detail div start-->	
  	<div data-role="header" data-position="fixed" id="hdrSoloProductInfo">
		<div class="headerlogo"> </div>
		<div class="headertext">
		   Product Detail 
		</div>
		<div data-role="controlgroup" data-type="horizontal" style="float:right;" >
		    <a href="index.html" data-role="button" >Home</a>
			<a href="?" data-role="button" >Back</a>
		</div>
	</div>
 
  	<div data-role="content" id="contentSoloProductInfo"> 
	    
  	</div>
    
  	<div data-role="footer" id="ftrSoloProductInfo">
       <div data-role="controlgroup" id="ftrCtrlGrpSoloProductInfo" data-type="horizontal" style="float:center;" >
        	<a href="javascript:populateResultList();" data-role="button" >Back to results</a>
       </div>
  	</div>
 	<!--_____________________________for populating a particular product detail div end-->	  
 
 	<!--for populating lazy search form-->
 	<div data-role="header" data-position="fixed" id="hdrLazySearch">
    
	    <div class="headerlogo"> </div>
	    <div class="headertext">
	       Search Products
	    </div>
	    <div data-role="controlgroup" data-type="horizontal" style="float:right;" >
	        <a href="home.html" rel="external" data-role="button" >Home</a>
			<a href="?" data-role="button" >Back</a>
		</div>
  	</div>
 
  	<div data-role="content" id="contentLazySearch"> 
	    <p> Drop your search keywords here.We will guide you through the best available products</p> 
	    
	    <div id="setErrorMessage" style="color:red;">
	    	
    	</div>
	    
	    <form name="lazysearchform"  >
	    	<div align="center" data-role="fieldcontain">
		         <input type="text" name="searchkey"  placeholder="Enter Search Key" id="searchkey" value="" data-mini="true" />
		    </div>
		
		   	<div class="ui-body">
			<fieldset class="ui-grid-a">
					<div class="ui-block-b"><button id="searchproduct" type="submit" data-theme="a" data-mini="true">Search</button></div>
		    </fieldset>
			</div>
		</form> 
		<div id="getProductCount">
    	
    	</div>
  	</div>
	
	<div data-role="content" id="contentResultList" name="contentResultList">	
	     <div id="getProductCount">
	    	<!-- ajax populate -->
	     </div>



	 <div id="resultContainer" >
	 	<!-- ajax populate -->
	 </div>
	</div>
	
	<div data-role="footer" id="ftrLazySearch">
	     <h1></h1>
	</div>
	<!--for populating lazy search form--> 
 
 
	<!-- contentTransition is displayed after the form is submitted until a response is received back. -->
	<div data-role="content" id="contentTransition" name="contentTransition">	
	 <div align="CENTER"><h4>Please wait.</h4></div>
	 <div align="CENTER"><img id="spin" name="spin" src="css/images/ajax-loader.gif"/></div>
	</div><!-- contentTransition -->
	
</div>	

<script src="js/jquery.js"></script>
<script src="js/jquery.mobile-1.2.0.js"></script>

<script type="text/javascript">
	
	// javascript global variable declarations:
	var resobj_search = "" ;
	var resobj_prodlist = "" ;
	
	$(document).ready(function() {
		showPageSearchForm();
		
	});

	$('#searchproduct').click( function ()  {
		showPageTransition();
		doProcessInputs();
		return false;  // !mandatory
	});

	$('#viewcategory').click(function () {	
		showPageTransition();
		showPageSellerCategoryList();
		getSellerCategory();
		return(false); // ! mandatory
	});
	
	$('#viewproducts').click(function () {	
		showPageTransition();
		showPageProductsUnderCategory();
		getProductsUnderCategory();
		return(false); // ! mandatory
	});
	
	$('#viewproductdetail').click(function () {	
		showPageTransition();
		showPageSoloProductInfo();
		getSoloProductInfo();
		return(false); // ! mandatory
	});
	
    
 	function doProcessInputs()
	{
		var searchkey=$("#searchkey").val();
		var serviceurl = '../services/lazysearchaction.php' ;
		
		$.post(
			serviceurl ,
			{ 	
			    searchkey : searchkey,             
				action:'searchproduct'	
			} ,
		 	function(data){
		 	    resobj_search =jQuery.parseJSON(data);
			    populateResultList();
			}
		);  // end of $.post 
	}
	
	
	function populateResultList(){
		  
		 $('#resultContainer').html("");  //clear out previous result since append is used
    	 showPageSearchResults();  
    	 for(var i=0; i<resobj_search.length; i++)
    	 {
    	 	
    		var str = "";
    		str += '<table width="95%"><tr>';
    		str += 	'<td>';
		    str +=		'<p>' ;
		    str +=			'<b>'+ resobj_search[i].name + '</b><br>' ;
		    str +=			resobj_search[i].description + '<br>' ;
		    str +=			'in Category :'+ resobj_search[i].category + '<br>' ;
		    str +=			'in Stock :'+ resobj_search[i].count + '<br>' ;
		    str +=			'Seller : '+ resobj_search[i].sellerid  + '<br>' ;
		    str +=		'</p>' ;
	    	str +=   '</td><tr><td>' ;
    		str +=    	'<a href="javascript:getProductConfig('+i+');"> View Product </a><hr>';
    		str +=   '</td>' ;
    		str += '</tr></table>  <br><br>';
    		
    		$('#resultContainer').append(str);		 	
    	 }
    }
    

 	function getProductConfig(i) 
 	{
 		var serviceurl = '../services/productsearchutils.php' ;
		
		$.post(
			serviceurl ,
			{ 	
			    prod_id: resobj_search[i].prod_no,
				action:'getProductConfiguration'	
			} ,
		 	function(data){
		 		var resobj =jQuery.parseJSON(data);
			    populateSoloProductInfo(resobj);
			}
		);  // end of $.post --

	}
    
    function populateSoloProductInfo(resobj) 
    {  	
    	var str = "";
    		str += '<table>';
    		
		for (var propName in resobj) {
			//  console.log("Iterating through prop with name", propName, " its value is ", resobj[propName])
			str += '<tr>';		
			str += 	 '<td>'+propName+'</td> 		<td>:</td>	<td><b>'+ resobj[propName] + '</b></td>' ;
			str += '</tr>';	
		}			
			str +=	 "<tr><td><br><a href='javascript:getSellerProfileInfo(\""+resobj.Seller+"\");'> Seller Profile > </a><br></td>"
			str += '</tr>';    
		    str += '</table> ';
		$('#contentSoloProductInfo').html("");   
		showPageSoloProductInfo();	
		$('#contentSoloProductInfo').append(str);
		
    }
    
   	function getSellerProfileInfo(sellerid) 
	{
		var serviceurl = '../services/accesscontrolaction.php' ;
		$.post(
			serviceurl ,
			{ 	
			    seller:sellerid,
				action:'getProfileInfo'	
			} ,
		 	function(data){
			    var resobj =jQuery.parseJSON(data);
			    populateContentProfileInfo(resobj);
			}
		);  // end of $.post --
	}
	
	function populateContentProfileInfo(resobj)
	{	var str = "";
    			str += '<table "border=0">' ;
    			str += 		'<tr><td>display_name:</td><td><b>'+ resobj[0].display_name + '</b></td></tr>' ;
    			str +=		'<tr><td>seller_id:</td><td><b>'+ resobj[0].seller_id + '</b></td></tr>' ;
    			str +=		'<tr><td>email:</td><td><b>'+ resobj[0].email + '</b></td></tr>' ;
    			str +=		'<tr><td>address:</td><td><b>'+ resobj[0].address + '</b></td></tr>' ;
    			str +=      '<tr><td>zipcode:</td><td><b>'+ resobj[0].zipcode + '</b></td></tr>' ;
    			str +=		'<tr><td>ph_no:</td><td><b>'+ resobj[0].ph_no + '</b></td></tr>' ;
    			str +=		'<tr><td>landmark:</td><td><b>'+ resobj[0].landmark + '</b></td></tr>' ;	
    			str +=		'<tr><td>near_city:</td><td><b>'+ resobj[0].near_city + '</b></td></tr>' ;	
    			str +=	'</table>';
    			
    			str +=	'<div>';
    			str +=	  "<br><a href='javascript:getSellerCategoryList(\""+resobj[0].seller_id+"\");'> View Store  </a><br>" ;
    			str +=	'</div>';
    			
     	 $('#contentProfileInfo').html("");
    	 showPageProfileInfo();
     	 $('#contentProfileInfo').append(str);
    }
    
    function getSellerCategoryList(sellerid) 
    {	
    	showPageTransition();
		var serviceurl = '../services/productsearchutils.php' ;
		$.post(
			serviceurl ,
			{ 	
			    seller:sellerid,
				action:'getSellerCategoryList'	
			} ,
		 	function(data){
			    var resobj =jQuery.parseJSON(data);
			    populateSellerCategoryList(resobj, sellerid);
			}
		);  // end of $.post --
	}
    
    function populateSellerCategoryList(resobj, sellerid) 
    {
		$('#ulCategoryList').html("<li> </li>");
    	showPageSellerCategoryList();
    	for(i=0;i<resobj.length;i++)
    	{
 	    	var str =  "";
 	    		str += '<li>';
 	    		str +=	  "<a style='text-decoration:none;' href='javascript:getProductsUnderCategory(\""+resobj[i].category+"\",\""+sellerid+"\");'> "+resobj[i].category+" </a>" ;
 	    		str += '</li>'	
 	    	$('#ulCategoryList').append(str);
		}
    }
    
    function getProductsUnderCategory(category, sellerid) 
    {
		var serviceurl = '../services/productsearchutils.php' ;
		$.post(
			serviceurl ,
			{ 	
			    seller:sellerid,
			    category:category,
				action:'getProductsUnderCategoryList'	
			} ,
		 	function(data){
			    var resobj =jQuery.parseJSON(data);
			    populateProductsUnderCategory(resobj);
			}
		);  // end of $.post --

	}
    
    function populateProductsUnderCategory(resobj) {
    	resobj_search = resobj;
    	populateResultList();
    }
    


		
    
/* page builders --------------------------------*/
	
	function showPageTransition()
	{	
		hideSearchProductForm();
		hideSearchResultList();
		hideSoloProductInfo();
		hideSellerCategory();
		hideProfileInfo();
		hideProductUnderCategory();
		$('#contentTransition').show();
	}
	
	function showPageSearchForm()
	{	
		hideSoloProductInfo();
		hideSearchResultList();
		hideSellerCategory();
		hideProfileInfo();
		hideProductUnderCategory();
		$('#contentTransition').hide();
		showSearchProductForm();
	}
	
	function showPageSearchResults()
	{	
		hideSearchProductForm();
		hideSoloProductInfo();
		hideSellerCategory();
		hideProfileInfo();
		hideProductUnderCategory();
		$('#contentTransition').hide();
		showSearchResultList();
	}	
	
	function showPageProfileInfo()
	{
		hideSearchProductForm();
		hideSearchResultList();
		hideSoloProductInfo();
		$('#contentTransition').hide();
		hideSellerCategory();		
		hideProductUnderCategory();
		showProfileInfo();
	}
	
	function showPageSellerCategoryList()
	{	
		hideSearchProductForm();
		hideSearchResultList();
		hideSoloProductInfo();
		$('#contentTransition').hide();
		hideProfileInfo();
		hideProductUnderCategory();
		showSellerCategory();
	}
	
	function showPageProductsUnderCategory()
	{	
		hideSearchProductForm();
		hideSearchResultList();
		hideSoloProductInfo();
		$('#contentTransition').hide();
		hideSellerCategory();
		hideProfileInfo();
		showProductUnderCategory();
	}
	
	function showPageSoloProductInfo()
	{	
		hideSearchProductForm();
		hideSearchResultList();
		hideSellerCategory();
		hideProfileInfo();
		hideProductUnderCategory();
		$('#contentTransition').hide();
		showSoloProductInfo();
	}

	
	
	function hideSoloProductInfo(){
			$('#hdrSoloProductInfo').hide();	
			$('#contentSoloProductInfo').hide();
			$('#ftrSoloProductInfo').hide();
	}	
		function showSoloProductInfo(){
				$('#hdrSoloProductInfo').show();	
				$('#contentSoloProductInfo').show();
				$('#ftrSoloProductInfo').show();
		}
	
	function hideSellerCategory(){
			$('#hdrSellerCategory').hide();	
			$('#contentSellerCategory').hide();
			$('#ftrSellerCategory').hide();
	}
		function showSellerCategory(){
				$('#hdrSellerCategory').show();	
				$('#contentSellerCategory').show();
				$('#ftrSellerCategory').show();
		}
	
	function hideProfileInfo(){
			$('#hdrProfileInfo').hide();
			$('#contentProfileInfo').hide();
			$('#ftrProfileInfo').hide();
	}
		function showProfileInfo(){
				$('#hdrProfileInfo').show();
				$('#contentProfileInfo').show();
				$('#ftrProfileInfo').show();
		}
	
	function hideProductUnderCategory(){
			$('#hdrProductUnderCategory').hide();
			$('#contentProductUnderCategory').hide();
			$('#ftrProductUnderCategory').hide();
	}
		function showProductUnderCategory(){
				$('#hdrProductUnderCategory').show();
				$('#contentProductUnderCategory').show();
				$('#ftrProductUnderCategory').show();
		}
/*---------------------------------------------*/
	function hideSearchProductForm(){
		$('#hdrLazySearch').hide();
		$('#contentLazySearch').hide();
		$('#ftrLazySearch').hide();
	}
		function showSearchProductForm(){
			$('#hdrLazySearch').show();
			$('#contentLazySearch').show();
			$('#ftrLazySearch').show();
		}

	function hideSearchResultList(){
		$('#hdrLazySearch').hide();
		$('#contentResultList').hide();
		$('#ftrLazySearch').hide();
	}
	function showSearchResultList(){
			$('#hdrLazySearch').show();
			$('#contentResultList').show();
			$('#ftrLazySearch').show();
	}



    
</script>

</div>



</body>
</html>


